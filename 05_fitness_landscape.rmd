---
editor_options:
  chunk_output_type: console
---

```{r prep_libs_05, eval=FALSE}
# data libraries
library(readr)
library(dplyr)
library(purrr)
library(glue)
library(tidyr)

# plotting
library(ggplot2)
library(patchwork)
library(scico)
```

```{r read_fl_data, eval=FALSE}
data = read_csv("data/info/data_fitness_landscape.csv")
```

```{r}
data = group_by(data, phi, leader_choices) %>% 
  nest()

# prepare plots
data = mutate(data,
              plot = pmap(list(phi, leader_choices, data), 
                          function(phi, leader_choices, data){
                plot = ggplot(data, 
                            aes(a,b))+
                  geom_tile(aes(fill = energy),
                            col = "grey")+
                  geom_tile(data = tibble(a = 0, b = 0),
                            col = "red",
                            fill = NA,
                            width = 0.5,
                            height = 0.5,
                            size = 0.2)+
                  scale_fill_scico(palette = "broc")+
                  coord_fixed(expand = FALSE)+
                  theme_test(base_size = 6)+
                  facet_grid(rep~flr, labeller = label_both)+
                  labs(title = glue::glue('Î¦ (number of peaks): {phi}, simulation type: info'),
                       subtitle = glue::glue('# leader choices: {leader_choices}'))
              }))
```


```{r prep_plot, eval=FALSE}
library(patchwork)
data = arrange(data, phi)
fig_list = wrap_plots(data$plot, ncol = 3)
```

